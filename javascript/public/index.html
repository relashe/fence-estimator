<html>
  <head>
    <meta charset="UTF-8" />
    <title>Fence Estimator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  </head>
  <body>
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="fence-estimator container-fluid p-0">
              <div class="fence-estimator__container row no-gutters">
                <div class="col-md-5 px-4 py-4">
                  <div class="d-md-flex flex-column justify-content-center">
                    <h2 class="mb-auto">Land Area Estimator</h2>

                    <div class="map-search-controller py-5">
                      <h4>Search Address</h4>
                      <form class="form-inline">
                        <div class="form-group mb-2">
                          <input
                            type="text"
                            class="search-address__field form-control-plaintext border"
                            id="staticEmail2"
                          />
                        </div>
                      </form>
                    </div>
                    <div class="map-search-results-controller py-5" aria-hidden="true">
                      <h4 class="map-search-results__address mb-4"></h4>
                      <div class="map-search-results__step-1" aria-hidden="true">
                        <button type="button" class="plotting__start-button elementor-button mr-4">
                          Start New Plot
                        </button>
                        <button type="button" class="search-address__new-search-button elementor-button">
                          Search New Address
                        </button>
                      </div>
                      <div class="map-search-results__step-2" aria-hidden="true">
                        <button type="button" class="plotting__undo-button btn btn-secondary mr-4">
                          Undo
                        </button>
                        <button type="button" class="reset-button elementor-button">
                          Reset and Start Again
                        </button>
                      </div>
                    </div>
                    <div class="map-plotting-results-controller mt-auto" aria-hidden="true">
                      <h4>
                        Estimated Perimiter
                        <span class="map-plotting-results__perimiter ml-3"></span>
                      </h4>
                      <button type="button" class="plotting__accept-button elementor-button btn-block">
                        Continue with Estimated Land Area
                      </button>
                    </div>
                  </div>
                </div>
                <div class="fence-estimator__map col-md-7">
                  <div id="fence-estimator-map"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer"></div>
        </div>
      </div>
    </div>

    <input class="amount_needed" type="text" />

    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
      Launch estimator
    </button>

    <!-- <div class="fence-estimator container-fluid p-0">
      <div class="fence-estimator__container row no-gutters">
        <div class="col-md-5 px-4 py-4">
          <div class="d-md-flex flex-column justify-content-center">
            <h2 class="mb-auto">Land Area Estimator</h2>

            <div class="map-search-controller py-5">
              <h4>Search Address</h4>
              <form class="form-inline">
                <div class="form-group mb-2">
                  <input type="text" class="search-address__field form-control-plaintext border" id="staticEmail2" />
                </div>
              </form>
            </div>
            <div class="map-search-results-controller py-5" aria-hidden="true">
              <h4 class="map-search-results__address mb-4"></h4>
              <div class="map-search-results__step-1" aria-hidden="true">
                <button type="button" class="plotting__start-button elementor-button mr-4">
                  Start New Plot
                </button>
                <button type="button" class="search-address__new-search-button elementor-button">
                  Search New Address
                </button>
              </div>
              <div class="map-search-results__step-2" aria-hidden="true">
                <button type="button" class="plotting__undo-button btn btn-secondary mr-4">
                  Undo
                </button>
                <button type="button" class="reset-button elementor-button">
                  Reset and Start Again
                </button>
              </div>
            </div>
            <div class="map-plotting-results-controller mt-auto" aria-hidden="true">
              <h4>
                Estimated Perimiter
                <span class="map-plotting-results__perimiter ml-3"></span>
              </h4>
              <button type="button" class="plotting__accept-button elementor-button btn-block">
                Continue with Estimated Land Area
              </button>
            </div>
          </div>
        </div>
        <div class="fence-estimator__map col-md-7">
          <div id="fence-estimator-map"></div>
        </div>
      </div>
    </div> -->

    <script>
      window.addEventListener("fence-estimator-results", function(e) {
        if (!e.detail.perimiter) {
          return false;
        }

        // This is for when the input is present in the page
        var amountInput = document.querySelectorAll(".amount_needed")
          ? document.querySelectorAll(".amount_needed")[0]
          : null;

        if (amountInput) {
          amountInput.value = e.detail.perimiter;

          jQuery && jQuery(".amount_needed").trigger("wc-measurement-price-calculator-update");
        }

        console.log(e.detail.perimiter);

        // $("#exampleModal").modal("hide");
      });
    </script>

    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
